<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>タイピングの森</title>
  <meta name="description" content="小学生向けタイピング練習（ひらがな→アルファベット→ローマ字）" />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header class="container">
    <div class="topRow">
      <h1>🌲 タイピングの森</h1>
      <div class="topActions">
        <button id="themeToggle" type="button" class="chip" aria-label="テーマ切り替え">
          <span class="theme-icon">🌙</span>
          <span class="theme-label">ダーク</span>
        </button>
        <button id="badgesBtn" type="button" class="chip">🏅 バッジ <span id="badgeCount">0</span>/<span id="badgeTotal">20</span></button>
        <div class="badge" id="streakBadge" title="きょうのれんしゅう">きょう: 0</div>
      </div>
    </div>

    <section class="card" id="setupCard" aria-label="コース選択">
      <div class="courseRow">
        <div class="field inline">
          <label for="mode">コース</label>
          <select id="mode">
            <option value="kana">① ひらがな（ローマ字でうつ）</option>
            <option value="alpha">② アルファベット（A〜Z）</option>
            <option value="romaji">③ ローマ字（たんご/ぶんしょう）</option>
          </select>
        </div>

        <div class="field inline presets">
          <label>おすすめ</label>
          <div class="presetRow">
            <button type="button" class="presetBtn" data-preset="g1">小1</button>
            <button type="button" class="presetBtn" data-preset="g2">小2</button>
            <button type="button" class="presetBtn" data-preset="g3">小3</button>
            <button type="button" class="presetBtn" data-preset="g4">小4</button>
            <button type="button" class="presetBtn" data-preset="g5">小5</button>
            <button type="button" class="presetBtn" data-preset="g6">小6</button>
          </div>
        </div>
        <div class="field inline">
          <label for="level">レベル</label>
          <select id="level"></select>
        </div>
        <div class="field inline">
          <label for="length">もんだい数</label>
          <select id="length">
            <option value="10">10</option>
            <option value="20" selected>20</option>
            <option value="30">30</option>
          </select>
        </div>
        <div class="field inline">
          <label class="switch">
            <input id="soundToggle" type="checkbox" checked />
            <span>おと</span>
          </label>
        </div>
        <div class="actions">
          <button class="primary" id="startBtn" type="button">スタート</button>
          <button id="resetStatsBtn" class="danger" type="button">きろくをリセット</button>
        </div>
      </div>

      <div class="statsRow" aria-label="きろく">
        <div class="stat"><div class="k">さいきんのせいかいりつ</div><div class="v"><span id="acc">-</span>%</div></div>
        <div class="stat"><div class="k">さいきんのWPM</div><div class="v"><span id="wpm">-</span></div></div>
        <div class="stat"><div class="k">さいきんのスコア</div><div class="v"><span id="score">-</span></div></div>
        <div class="stat"><div class="k">ごうけいれんしゅう</div><div class="v"><span id="sessions">0</span> かい</div></div>
      </div>
      <div class="muted">※きろくはこのブラウザ（localStorage）にほぞんされます</div>
    </section>
  </header>

  <main class="container">
    <section class="card" id="gameCard" aria-label="れんしゅう" hidden>
      <div class="gameTop">
        <div class="promptWrap">
          <div class="promptLabel">もんだい</div>
          <div class="prompt" id="prompt">-</div>
          <div class="meaning" id="meaning"></div>
          <div class="hint" id="hint"></div>
        </div>
        <div class="scoreWrap">
          <div class="mini">のこり</div>
          <div class="big" id="remaining">0</div>
          <div class="mini">せいかい</div>
          <div class="big" id="correct">0</div>
          <div class="mini">ミス</div>
          <div class="big" id="miss">0</div>
        </div>
      </div>

      <div class="inputRow">
        <input id="typeInput" type="text" inputmode="latin" autocomplete="off" autocapitalize="off" spellcheck="false" placeholder="ここにうつ" />
        <button id="giveUpBtn" type="button">やめる</button>
      </div>

      <div class="keyboard" id="keyboard" aria-label="キーボード" hidden>
        <div class="keyRow" data-row="1"></div>
        <div class="keyRow" data-row="2"></div>
        <div class="keyRow" data-row="3"></div>
      </div>
    </section>

    <section class="card" id="resultCard" aria-label="けっか" hidden>
      <h2 style="text-align:center;font-size:28px;">🎉 おつかれさま！</h2>
      <div class="resultGrid">
        <div class="stat">
          <div class="k">🎯 せいかいりつ</div>
          <div class="v"><span id="rAcc">0</span>%</div>
          <div class="change" id="rAccChange"></div>
        </div>
        <div class="stat">
          <div class="k">⚡ WPM</div>
          <div class="v"><span id="rWpm">0</span></div>
          <div class="change" id="rWpmChange"></div>
        </div>
        <div class="stat">
          <div class="k">⭐ スコア</div>
          <div class="v"><span id="rScore">0</span></div>
          <div class="change" id="rScoreChange"></div>
        </div>
        <div class="stat">
          <div class="k">⏱ じかん</div>
          <div class="v"><span id="rTime">0</span>s</div>
        </div>
      </div>
      <div class="actions">
        <button class="primary" id="againBtn" type="button">▶ もういっかい</button>
        <button id="backBtn" type="button">🏠 もどる</button>
      </div>
    </section>
  </main>

  <dialog id="badgesDialog">
    <form method="dialog" class="dialog">
      <h3>🏅 バッジコレクション</h3>
      <p style="text-align:center;color:var(--muted);margin:0 0 16px 0;"><span id="badgeUnlocked">0</span>/<span id="badgeTotal2">20</span> かくとく</p>
      <div id="badgesGrid" class="badgesGrid"></div>
      <div class="actions" style="margin-top:20px;">
        <button value="ok" type="submit" class="primary">とじる</button>
      </div>
    </form>
  </dialog>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
  <script src="./app.js"></script>
</body>
</html>
